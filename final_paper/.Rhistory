mutate(percentage = arrestCount / totalCount)
stop_by_percentage_race$percentage <- round(stop_by_percentage_race$percentage, digits = 2)
stop_arrest <- ggplot(stop_by_percentage_race, aes(x = Race,
fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
facet_wrap(~Reason, nrow = 1)+
geom_text(aes(x=Race,
y=percentage,
label = paste0(percentage*100, "%")),
size=4,
colour= "#000000") +
scale_y_continuous(labels=percent, limits = c(0,1)) +
labs(title = "Probability of arrested by BPD of \na specific race for a specific reason (%)",
x = "Race",
y = "Density")+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank())+
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))+
guides(fill = FALSE)
map_reasons1 <- berkgg_zoom2 +
geom_point(aes(x = long,
y = lat,
colour = Reason),
data = stop_reason,
alpha = .7) +
theme (
panel.grid.major = element_blank (), # remove major grid
panel.grid.minor = element_blank (),  # remove minor grid
axis.text = element_blank (),
axis.title = element_blank (),
axis.ticks = element_blank ()) +
ggtitle("Police Stops by Reason")+
facet_grid(~Reason)+
guides(colour = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
stop_reason <- stop_reason %>%
group_by(Race, Reason) %>%
tally()
############################ create the maps ###########################
# arrest data histogram by race
arrest1 <- na.omit(arrest) %>%
group_by(Race) %>%
tally()
total <- arrest1 %>%
tally()
arresttotal <- 192
arrest1 <- arrest1 %>%
mutate(percentage = n/192)
arrest1$percentage <- round(arrest1$percentage, digits = 2)
jail1 <-na.omit(jail) %>%
group_by(Race) %>%
tally()
total <- jail1 %>%
tally()
jailtotal <- 242
jail1<- jail1 %>%
mutate(percentage = n/242)
jail1$percentage <- round(jail1$percentage, digits = 2)
bararrest<- ggplot(arrest1)+
geom_bar(aes(x=Race,
y= percentage),
stat = "identity",
fill = c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
geom_text(aes(x=Race,
y=percentage,
label = paste0(percentage*100,"%")),
size=5,
colour= "#000000")+
scale_y_continuous(labels=percent, limits = c(0,1)) +
labs(title = "The Percentage of Being Arrested \nAfter being Stopped (%)",
x = "Race",
y = "Percentage") +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))
barjail <- ggplot(jail1)+
geom_bar(aes(x=Race,
y=percentage),
stat = "identity",
fill = c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
geom_text(aes(x=Race,
y=percentage,
label = paste0(percentage*100,"%")),
size=5,
colour= "#000000")+
scale_y_continuous(labels=percent, limits = c(0,1)) +
labs(title = "The Percentage of Being jailed \nAfter being Stopped (%)",
x = "Race",
y = "Percentage") +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))
histogram_arrest1 <- ggplot(na.omit(arrest))+
geom_bar(aes(x=Age,
fill = Race))+
facet_grid(~Race)+
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
labs(x= "Age",
y = "Number of people",
title = "Arrest Data") +
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# jail data histogram by race
histogram_jail1 <- ggplot(na.omit(jail))+
geom_bar(aes(x=Age,
fill = Race))+
facet_grid(~Race)+
labs(x= "Age",
y = "Number of people",
title = "Jail Data") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# histogram of stop data by race and hour:
histogram_stoptime1 <- ggplot(stops,
aes(x = Hour,
fill = Race)) +
geom_bar(aes(y = ..count..)) +
facet_grid(~Race)+
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
labs(title = "Number of people each race in every hour",
y = "Count") +
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
table3$Percent.Stopped <- percent(table3$Percent.Stopped)
map_enforcement <- ggplot(table3)+
geom_bar(aes(x=Race,
y=Percent.Stopped,
fill = Race),
stat = "identity") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
scale_y_continuous(limits = c(0,1), labels = c("0%", "25%", "50%", "75%", "100%")) +
labs(title = "Police Stops Leading to Arrests",
x = "Race",
y = "Percent of Arrested") +
geom_text(aes(x=Race,
y=Percent.Stopped,
label = paste0(Percent.Stopped)),
size=5,
colour= "#000000")+
scale_x_discrete(labels = function(x) str_wrap(x, width = 5))+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 13),
axis.text.x=element_text(colour="black", size = 8),
axis.text.y=element_text(colour="black", size = 8))+
guides(fill = FALSE)
#map_enforcement
race_hour <- read.csv("../clean_data/race_hour.csv")
stop_percentage3 <- ggplot(race_hour, aes(x = Hour, fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(title = "Probability of BPD stop for \na specific race in a specific hour",
x= "Hour",
y = "Density") +
facet_wrap(~Race, nrow = 1) +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0")) +
scale_y_continuous(labels=percent, limits = c(0,1)) +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7)) +
guides(fill = FALSE)
age_hour <- read.csv("../clean_data/age_hour.csv")
stop_percentage2 <- ggplot(age_hour , aes(x = Hour, fill = AgeRange)) +
geom_bar(aes(y = percentage), stat="identity") +
facet_wrap(~AgeRange, nrow = 1)+
labs(title = "Probability of BPD stop for a \nspecific age range in a specific hour",
x= "Hour",
y = "Density") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0")) +
scale_y_continuous(labels=percent, limits = c(0,1)) +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7)) +
guides(fill = FALSE)
age_hour <- read.csv("../clean_data/age_hour.csv")
stop_percentage2 <- ggplot(age_hour , aes(x = Hour, fill = AgeRange)) +
geom_bar(aes(y = percentage), stat="identity") +
facet_wrap(~AgeRange, nrow = 1)+
labs(title = "Probability of BPD stop for a \nspecific age range in a specific hour",
x= "Hour",
y = "Density") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0")) +
scale_y_continuous(labels=percent, limits = c(0,1)) +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7)) +
guides(fill = FALSE)
map_enforcement
map_arrested1
warnings()
grid.arrange(map_arrested1, map_enforcement, ncol=1)
map_reasons1
stop_arrest_gender
stop_arrest_gender
# Probability of arrested by BPD of a specific gender for a specific reason
stop_by_reason_gender <-stops %>%
group_by(Gender, Reason) %>%
summarise(totalCount=n())
stop_by_arrest_gender <- stops[stops$Enforcement == "Arrest",] %>%
group_by(Gender, Reason) %>%
summarise(arrestCount = n())
stop_by_percentage_gender <- left_join(stop_by_reason_gender, stop_by_arrest_gender, by = c("Gender", "Reason"))
stop_by_percentage_gender <- stop_by_percentage_gender %>%
mutate(percentage = arrestCount / totalCount)
stop_by_percentage_gender$percentage <- round(stop_by_percentage_gender$percentage , digits=2)
stop_by_percentage_gender<- stop_by_percentage_gender[stop_by_percentage_gender$Reason != "Other",]
stop_arrest_gender <- ggplot(stop_by_percentage_gender , aes(x = Gender, fill = Gender)) +
geom_bar(aes(y = percentage), stat="identity") +
facet_wrap(~Reason, nrow=1)+
labs(title = "Probability of BPD stop for a \nspecific gender range in a specific reason",
x= "Hour",
y = "Density") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0")) +
scale_y_continuous(labels=percent, limits = c(0,1)) +
geom_text(aes(x=Gender,
y=percentage,
label = paste0(percentage*100, "%")),
size=3,
colour= "#000000")+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7)) +
guides(fill = FALSE)
stop_arrest_gender
stop_by_reason_age <- stops %>%
group_by(AgeRange, Reason) %>%
summarise(totalCount = n())
stop_by_arrest_age <- stops[stops$Enforcement == "Arrest",] %>%
group_by(AgeRange, Reason) %>%
summarise(arrestCount = n())
stop_by_percentage_age <- left_join(stop_by_reason_age, stop_by_arrest_age, by = c("AgeRange", "Reason"))
stop_by_percentage_age <- stop_by_percentage_age %>%
mutate(percentage = arrestCount / totalCount)
stop_by_percentage_age$percentage<-round(stop_by_percentage_age$percentage,digits = 2)
stop_by_percentage_age <- stop_by_percentage_age[stop_by_percentage_age$Reason != "Other",]
stop_arrest_age <- ggplot(stop_by_percentage_age, aes(x = AgeRange, fill = AgeRange)) +
geom_bar(aes(y = percentage), stat="identity") +
facet_wrap(~Reason, nrow=1)+
labs(title = "Probability of BPD stop for a \nspecific age range in a specific reason",
x= "Hour",
y = "Density") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0")) +
scale_y_continuous(labels=percent, limits = c(0,1)) +
geom_text(aes(x=AgeRange,
y=percentage,
label = paste0(percentage*100, "%")),
size=3,
colour= "#000000")+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7)) +
guides(fill = FALSE)
stop_arrest_age
stop_percentage2
stop_percentage3
grid.arrange(bararrest, barjail, ncol = 2)
map_stop1
grid.arrange(stopdensitymap4, popdenmap, ncol=2)
stopdensitymap3
popdenmap
stopdensitymap3
grid.arrange(stopdensitymap4, popdenmap, ncol=2) # figure 6
grid.arrange(a2,black2,h2,o2,w2, ncol = 5) # print population density by race.
############################ populatrion density map ###########################
popdenmap <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map, aes(x = long, y = lat, group = group, fill = Percent.Berkeley), color = "white", alpha = .7) +
ggtitle("2010 Population Density") +
labs(fill = "Percent") +
scale_fill_gradientn(colors = p) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))
# black population:
black2 <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map,
aes(x = long,
y = lat,
group = group,
fill = Percent.Black),
color = "white",
alpha = .7) +
scale_fill_gradientn(colors = p,
limits = c(0,1)) +
guides(fill = "none") +
ggtitle("% Black")+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# White population:
w2 <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map,
aes(x = long,
y = lat,
group = group,
fill = Percent.White),
color = "white",
alpha = .7) +
scale_fill_gradientn(colors = p,
limits = c(0,1)) +
guides(fill = "none") +
ggtitle("% White")+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# Asian population:
a2 <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map,
aes(x = long,
y = lat,
group = group,
fill = Percent.Asian),
color = "white",
alpha = .7) +
scale_fill_gradientn(colors = p,
limits = c(0,1)) +
guides(fill = "none") +
ggtitle("% Asian")+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# Hispanic population:
h2 <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map,
aes(x = long,
y = lat,
group = group,
fill = Percent.Hispanic),
color = "white",
alpha = .7) +
scale_fill_gradientn(colors = p,
limits = c(0,1)) +
guides(fill = "none") +
ggtitle("% Hispanic")+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# Other population:
o2 <- berkgg_zoom1 +
geom_polygon(data = berkcensus2010map,
aes(x = long,
y = lat,
group = group,
fill = Percent.Other),
color = "white",
alpha = .7) +
scale_fill_gradientn(colors = p,
limits = c(0,1)) +
guides(fill = "none") +
ggtitle("% Other")+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
grid.arrange(a2,black2,h2,o2,w2, ncol = 5) # print population density by race # figure 8
stop_percentage2 # figure 16
bararrest
############################ create the maps ###########################
# arrest data histogram by race
arrest1 <- na.omit(arrest) %>%
group_by(Race) %>%
tally()
total <- arrest1 %>%
tally()
arresttotal <- 192
arrest1 <- arrest1 %>%
mutate(percentage = n/192)
arrest1$percentage <- round(arrest1$percentage, digits = 2)
jail1 <-na.omit(jail) %>%
group_by(Race) %>%
tally()
total <- jail1 %>%
tally()
jailtotal <- 242
jail1<- jail1 %>%
mutate(percentage = n/242)
jail1$percentage <- round(jail1$percentage, digits = 2)
bararrest<- ggplot(arrest1)+
geom_bar(aes(x=Race,
y= percentage),
stat = "identity",
fill = c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
geom_text(aes(x=Race,
y=percentage,
label = paste0(percentage*100,"%")),
size=5,
colour= "#000000")+
scale_y_continuous(labels=percent, limits = c(0,1)) +
labs(title = "Races Arrested in 30 Days (%)",
x = "Race",
y = "Percentage") +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))
barjail <- ggplot(jail1)+
geom_bar(aes(x=Race,
y=percentage),
stat = "identity",
fill = c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
geom_text(aes(x=Race,
y=percentage,
label = paste0(percentage*100,"%")),
size=5,
colour= "#000000")+
scale_y_continuous(labels=percent, limits = c(0,1)) +
labs(title = "Races Jailed in 30 Days (%)",
x = "Race",
y = "Percentage") +
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank()) +
theme(plot.title = element_text(size = 12, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 10),
axis.text.x=element_text(colour="black", size = 7),
axis.text.y=element_text(colour="black", size = 7))
histogram_arrest1 <- ggplot(na.omit(arrest))+
geom_bar(aes(x=Age,
fill = Race))+
facet_grid(~Race)+
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
labs(x= "Age",
y = "Number of people",
title = "Arrest Data") +
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# jail data histogram by race
histogram_jail1 <- ggplot(na.omit(jail))+
geom_bar(aes(x=Age,
fill = Race))+
facet_grid(~Race)+
labs(x= "Age",
y = "Number of people",
title = "Jail Data") +
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
# histogram of stop data by race and hour:
histogram_stoptime1 <- ggplot(stops,
aes(x = Hour,
fill = Race)) +
geom_bar(aes(y = ..count..)) +
facet_grid(~Race)+
scale_fill_manual(values=c("#FFCC00","#E1B378","#5F9EA0","#66FFCC","#40B8D0"))+
labs(title = "Number of people each race in every hour",
y = "Count") +
guides(fill = FALSE)+
theme(plot.title = element_text(size = 14, family = "Georgia", face = "bold"),
text=element_text(family="Times New Roman", size = 14),
axis.text.x=element_text(colour="black", size = 10),
axis.text.y=element_text(colour="black", size = 10))
grid.arrange(bararrest, barjail, ncol = 2) # figure 17
