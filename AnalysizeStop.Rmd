---
title: "Analyze Stop Data"
author: "Mengyu Li"
date: "July 22, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)

# Read data
stop_by <- read_csv("cleaned_stop_data.csv")

stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)

stop_by <- stop_by %>%
  mutate(hour = hour(Call.Date.Time))

#Race, Gender, and Reason
stop_race <- ggplot(stop_by, aes(x = Race, fill = Gender)) + 
  geom_bar(aes(y = ..count../sum(..count..))) + 
  scale_fill_manual(values = c("skyblue1", "pink")) +
  labs(y = "Density") +
  facet_wrap(~Reason)
#Remove input "E" in the R column

#Reason, Gender, and Enforcement
stop_reason <- ggplot(stop_by, aes(x = Reason, fill = Gender)) + 
  geom_bar(aes(y = ..count../sum(..count..))) + 
  scale_fill_manual(values = c("skyblue1", "pink")) +
  labs(y = "Density") +
  facet_wrap(~Enforcement)


stop_age <- ggplot(stop_by, aes(x = AgeRange, fill = Gender)) + geom_bar() 
stop_reason <- ggplot(stop_by, aes(x = Reason, fill = Gender)) + geom_bar()
stop_time <- ggplot(stop_by, aes(x = hour, fill = AgeRange)) + geom_bar()

stop_race
stop_reason


View(stop_by)
```

