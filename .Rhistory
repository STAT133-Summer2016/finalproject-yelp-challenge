rsconnect::deployApp('/Users/Gabrielle/Documents/Master/stat133/Homework/third_app')
shiny::runApp('Documents/Master/stat133/stat133/hw6/bonus_app')
library(ggvis)
library(ggplot2)
library(shiny)
library(ggvis)
library(dplyr)
runApp('Documents/Master/stat133/stat133/hw6/bonus_app')
library(tidyr)
library(xml2)
library(dplyr)
populationData = read_csv("population.csv")
lifeexpectancyData = read_csv("lifeexpectancy.csv")
gdpData = read_csv("gdppc.csv")
region = read_csv("Country.csv")
populationData <- populationData[ ,1:82]
populationData <- populationData[1:275, ]
lifeexpectancyData <- lifeexpectancyData[1:260, ]
gdpData <- gdpData[1:260, ]
region <- region[, 1:2]
yearVector = c(seq(from = 1800, to = 1950, by = 10),  c(1951:2015))
names(populationData) = c("country", yearVector)
lifeExpectancyYear <- c(1800:2015)
names(lifeexpectancyData) <- c("country", lifeExpectancyYear)
names(gdpData) <- c("country", lifeExpectancyYear)
populationData <- inner_join(populationData, region)
lifeexpectancyData <- inner_join(lifeexpectancyData, region)
gdpData <- inner_join(gdpData, region)
page <- read_html("https://en.wikipedia.org/wiki/List_of_nuclear_reactors")
populationData <- gather(populationData, key = year, value = population, -country, -Region)
lifeexpectancyData <- gather(lifeexpectancyData, key = year, value = life, -country, -Region)
gdpData <- gather(gdpData, key = year, value = gdp, -country, -Region)
finalData <- full_join(populationData, lifeexpectancyData)
finalData <- full_join(finalData, gdpData)
count = 0
for(i in c(1:nrow(finalData))) {
if(is.na(finalData[[4]][i])) {
count = count + 1
populationDecades = rep(0,10)
thisCountry = finalData[[1]][i]
thisYear = as.numeric(finalData[[3]][i])
yearDecades = c(((thisYear%/%10)*10) : ((thisYear%/%10)*10+9))
yearDecades = as.character(yearDecades)
for (j in c(1:10)) {
selectedRow <- finalData %>%
filter(country == thisCountry) %>%
filter(year == yearDecades[j])
populationDecades[j] = selectedRow[[4]][1]
}
finalData[[4]][i] = mean(populationDecades, na.rm = TRUE)
print(count)
}
}
finalData <- finalData %>%
filter(is.finite(population) & !is.na(population)) %>%
filter(!is.na(life)) %>%
filter(!is.na(gdp))
write.csv(finalData, "cleaned_demographics.csv")
library(readr)
populationData = read_csv("population.csv")
lifeexpectancyData = read_csv("lifeexpectancy.csv")
gdpData = read_csv("gdppc.csv")
region = read_csv("Country.csv")
getwd
getwd()
shiny::runApp('Documents/Master/stat133/Homework/test_aoo')
runApp('Documents/Master/stat133/Homework/test_aoo')
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(stringr)
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(hour = hour(Call.Date.Time))
stop_by <- read_csv("cleaned_stop_data.csv")
setwd("~/Documents/Master/stat133/finalproject_angry_ladies")
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by <- stop_by %>%
mutate(hour = hour(Call.Date.Time))
stop_race <- stop_by %>%
ggvis(x = ~Race, fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
library(ggvis)
stop_race <- stop_by %>%
ggvis(x = ~Race, fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~hour, fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
View(stop_by)
is.factor(stop_by$hour)
stop_time <- stop_by %>%
ggvis(x = ~unclass(hour), fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(hour), fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(hour), fill = ~unclass(Race)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(Race), fill = ~unclass(Race)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(Race), fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(Reason), fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_by$hour <- is.factor(stop_by$hour)
stop_by <- stop_by %>%
mutate(Hour = hour(Call.Date.Time))
stop_by$Hour <- is.factor(stop_by$Hour)
ggvis(x = ~Hour, fill = ~unclass(AgeRange)) %>%
flkasjdf
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
str(stop_by)
stop_by <- stop_by %>%
mutate(Hour = as.character(hour(Call.Date.Time)))
str(hour)
str(stop_by)
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = as.character(hour(Call.Date.Time)))
stop_by$Hour <- is.factor(stop_by$Hour)
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = as.character(hour(Call.Date.Time)))
str(stop_by)
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
typeof(stop_by$Hour)
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~unclass(Hour), fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~unclass(Hour), fill = ~unclass(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~unclass(Hour), fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = hour(Call.Date.Time))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~factor(Hour), fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = as.factor(hour(Call.Date.Time)))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~factor(Hour), fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~factor(AgeRange)) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_histograms() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width")) %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_bars(width = input_slider(1, 12, step = 2, label = "width")) %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~hour, fill := "pink") %>%
layer_bars(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_time <- stop_by %>%
ggvis(x = ~hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = hour(Call.Date.Time))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill = ~AgeRange) %>%
layer_bars(width = input_slider(1, 12, step = 2, label = "width")) %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_time
stop_time <- stop_by %>%
ggvis(x = ~hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by <- stop_by %>%
mutate(Hour = hour(Call.Date.Time))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by <- stop_by %>%
mutate(Hour = as.integer(hour(Call.Date.Time)))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
typeof(stop_by$Hour)
is.factor(stop_by$Hour)
stop_time <- stop_by %>%
ggvis(x = ~factor(Hour), fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill := "pink") %>%
layer_histograms(width = input_slider(1, 12, step = 2, label = "width"))
stop_time
stop_time_percentage <- ggplot(stop_by, aes(x = Hour, fill = AgeRange)) +
geom_bar(aes(y = ..count../sum(..count..))) +
labs(y = "Density") +
facet_wrap(~AgeRange)
stop_time_percentage
stop_by_hourCount <- stop_by %>%
group_by(Hour) %>%
summarise(hourcount = n())
stop_by_ageRangeCount <- stop_by %>%
group_by(Hour, AgeRange) %>%
summarise(ageCount = n())
stop_by_percentage <- left_join(stop_by_ageRangeCount, stop_by_hourCount)
stop_by_percentage <- stop_by_percentage %>%
mutate(percentage = ageCount/hourcount)
stop_time_percentage2 <- ggplot(stop_by_percentage, aes(x = Hour, fill = AgeRange)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(y = "Density") +
facet_wrap(~AgeRange)
stop_time_percentage2
stop_by_hourCount <- stop_by %>%
group_by(Hour) %>%
summarise(hourcount = n())
stop_by_raceRangeCount <- stop_by %>%
group_by(Hour, Race) %>%
summarise(raceCount = n())
stop_by_percentage1 <- left_join(stop_by_raceRangeCount, stop_by_hourCount)
stop_by_percentage1 <- stop_by_percentage1 %>%
mutate(percentage = raceCount/hourcount)
View(stop_by_percentage1)
stop_time_percentage2 <- ggplot(stop_by_percentage, aes(x = Hour, fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(y = "Density") +
facet_wrap(~Race)
stop_time_percentage2
stop_time_percentage2 <- ggplot(stop_by_percentage, aes(x = Hour, fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(y = "Density") +
facet_wrap(~Race)
stop_time_percentage2
stop_time_percentage2 <- ggplot(stop_by_percentage1, aes(x = Hour, fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(y = "Density") +
facet_wrap(~Race)
stop_time_percentage2
stop_by_reason_race <- stop_by %>%
group_by(Race, Reason) %>%
summarise(totalCount = n())
stop_by_arrest <- stop_by %>%
filter(Enforcement == "A") %>%
group_by(Race, Reason) %>%
summarise(arrestCount = n())
stop_by$Enforcement
stop_by_arrest <- stop_by %>%
filter(Enforcement == "A")
stop_by_arrest <- stop_by %>%
filter(stop_by$Enforcement == "A") %>%
group_by(Race, Reason) %>%
summarise(arrestCount = n())
library(dplyr)
stop_by_reason_race <- stop_by %>%
group_by(Race, Reason) %>%
summarise(totalCount = n())
View(stop_by_reason_race)
stop_by_arrest <- stop_by %>%
filter(Enforcement == "A")
helo
help("filter")
library(dplyr)
help("filter")
help("filter")
View(stop_by)
stop_by_arrest <- stop_by %>%
filter(Enforcement == "C")
stop_by %>%
filter(Enforcement == "C")
library(tidyr)
library(dplyr)
library(stringr)
#Read data
stop_df <- read.csv("~/Desktop/Berkeley_PD_-_Stop_Data.csv")
# Delete meaningless information and fix data entry errors
stop_df <- stop_df %>%
mutate(Dispositions = as.character(stop_df$Dispositions)) %>%
mutate(Dispositions = str_replace(Dispositions, "zz do not use Assist", "")) %>%
mutate(Dispositions = str_replace(Dispositions, "FA - TIGHT, ", "")) %>%
mutate(Dispositions = str_replace(Dispositions, "[0]{6}[1]?", "00000"))
# Isolates information about the case into the Other column
stop_df <- stop_df %>%
mutate(Other = str_replace_all(Dispositions, "[ ,]{0,2}[a-zA-Z0-9]{6}", "")) %>%
mutate(Other = str_replace_all(Other, "^[ ,]{0,4}", "")) %>%
mutate(Other = str_replace(Other, ",$", ""))
# Isolates information about the individual(s) into the Dispositions column
OtherInformation <- c( "^M$" = "", ", M$" = "", "M, P$" = "", "P[, ]{0,2}" = "", "AR[, ]{0,2}" = "", "IN[, ]{0,2}" = "", "FC[, ]{0,2}" = "", "CO[, ]{0,2}" = "", "MH[, ]{0,2}" = "", "TOW[, ]{0,2}" = "", "0[, ]{0,2}" = "", "00000[, ]{0,2}" = "")
stop_df <- stop_df %>%
mutate(Dispositions = str_replace_all(Dispositions, OtherInformation)) %>%
mutate(Dispositions = str_replace_all(Dispositions, "[, ]{0,2}$", ""))
# Arranges information in the Dispositions column into separate objects for each individual involved
stop_df <- stop_df %>%
separate(Dispositions, into = c("1", "2", "3", "4", "5"), extra = "merge", fill = "right") %>%
gather(key = Individual, value = Dispositions, -Incident.Number, -Incident.Type, -Call.Date.Time, -Other, -Location) %>%
na.omit() %>%
arrange(Incident.Number)
# Separates information about the individual into 6 columns describing race, gender, age, reason, enforcement, and car search
stop_df <- stop_df %>%
filter(nchar(Dispositions) == 6) %>%
mutate(Race = substr(Dispositions,1,1)) %>%
mutate(Gender = substr (Dispositions,2,2)) %>%
mutate(AgeRange = substr (Dispositions,3,3)) %>%
mutate(Reason = substr(Dispositions,4,4)) %>%
mutate(Enforcement = substr(Dispositions,5,5)) %>%
mutate(CarSearch = substr(Dispositions,6,6))
ageVector <- c("1" = "0-18", "2" = "18-29", "3" = "30-39", "4" = "40+")
stop_df$AgeRange = str_replace_all(stop_df$AgeRange, ageVector)
stop_df$Reason <- str_replace(stop_df$Reason, "E", "W")
row.names(stop_df) <- FALSE
write.csv(stop_df, "cleaned_stop_data.csv")
View(stop_df)
rep(0,8)
write.csv(stop_df, "cleaned_stop_data.csv", row.names = FALSE)
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(stringr)
library(ggvis)
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = as.integer(hour(Call.Date.Time)))
stop_by_reason_race <- stop_by %>%
group_by(Race, Reason) %>%
summarise(totalCount = n())
stop_by_arrest <- stop_by %>%
filter(Enforcement == "C") %>%
group_by(Race, Reason) %>%
summarise(arrestCount = n())
stop_by_arrest <- stop_by %>%
filter(Enforcement == "A") %>%
group_by(Race, Reason) %>%
summarise(arrestCount = n())
View(stop_by_arrest)
stop_by_percentage <- left_join(stop_by_reason_race, stop_by_arrest)
stop_by_percentage_race <- left_join(stop_by_reason_race, stop_by_arrest)
View(stop_by_percentage_race)
stop_by_percentage_race <- stop_by_percentage_race %>%
mutate(percentage = arrestCount / totalCount)
stop_arrest <- ggplot(stop_by_percentage_race, aes(x = Race, fill = Race)) +
geom_bar(aes(y = percentage), stat="identity") +
labs(y = "Density") +
facet_wrap(~Reason)
stop_arrest
View(stop_by_percentage_race)
