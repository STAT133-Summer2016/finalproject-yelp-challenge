stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_histograms() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
library(readr)
library(ggplot2)
library(dplyr)
library(lubridate)
library(stringr)
library(ggvis)
library(tidyr)
setwd("~/Documents/Master/stat133/final_angry_ladies")
setwd("~/Documents/Master/stat133/finalproject_angry_ladies")
stop_by <- read_csv("cleaned_stop_data.csv")
stop_by$Call.Date.Time <- mdy_hm(stop_by$Call.Date.Time)
stop_by$AgeRange <- as.factor(stop_by$AgeRange)
stop_by <- stop_by %>%
mutate(Hour = as.integer(hour(Call.Date.Time))) %>%
mutate(Day = as.factor(as.integer(wday(Call.Date.Time))))
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_histograms() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_race <- stop_by %>%
ggvis(x = ~Race , fill = ~AgeRange) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$AgeRange)
stop_race
stop_race_table
stop_race_total_table <- stop_by %>%
group_by(Race) %>%
summarise(totaLCount = n())
stop_race_agerange_table <- stop_by %>%
group_by(Race, AgeRange) %>%
summarise(count = n())
stop_race_table <- left_join(stop_race_agerange_table, stop_race_total_table, by = "Race")
stop_race_table <- stop_race_table %>%
mutate(percentage = count/totaLCount) %>%
select(-count)
stop_race_table <- stop_race_table %>%
spread(key = AgeRange, value = percentage)
stop_race_table
stop_time_percentage <- ggplot(stop_by, aes(x = Hour, fill = AgeRange)) +
geom_bar(aes(y = ..count..)) +
labs(y = "Count") +
facet_wrap(~Race)
stop_time_percentage
stop_day <- stop_by %>%
ggvis(x = ~Day, fill = ~Race) %>%
layer_bars() %>%
add_tooltip(function(stop_by) stop_by$Race)
stop_day
stop_time <- stop_by %>%
ggvis(x = ~Hour, fill := "lightpink") %>%
layer_histograms(width = input_slider(1, 12, value = 1, step = 2, label = "width"))
stop_time
